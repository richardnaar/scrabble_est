<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrabble Online</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
        iframe { border: none; width: 90vw; height: 90vh; }
    </style>
</head>
<body>
    <h1>Scrabble Eesti</h1>
    <script>/* <iframe src="https://docs.google.com/spreadsheets/d/1nT-_QMeKag7tyI_H3UEfpJjMGdsoiyLfCXMpt8yNy-I/edit?usp=sharing&headers=false" width="90%" height="600px"></iframe> */</script>
    <iframe src="https://docs.google.com/spreadsheets/d/1nT-_QMeKag7tyI_H3UEfpJjMGdsoiyLfCXMpt8yNy-I/edit?usp=sharing&widget=true&chrome=false" width="90%" height="600px"></iframe>


<script>
  function enterFullScreen() {
    var elem = document.documentElement; // The whole page
    if (elem.requestFullscreen) {
      elem.requestFullscreen();
    } else if (elem.mozRequestFullScreen) { // Firefox
      elem.mozRequestFullScreen();
    } else if (elem.webkitRequestFullscreen) { // Chrome, Safari, Opera
      elem.webkitRequestFullscreen();
    } else if (elem.msRequestFullscreen) { // IE/Edge
      elem.msRequestFullscreen();
    }
  }
</script>

<button onclick="enterFullScreen()" style="position: fixed; top: 10px; right: 10px; padding: 10px 15px; font-size: 16px;">
  Mine täisekraanile
</button>   
    <script>
  window.onload = function() {
    setTimeout(function() {
      alert("Täisekraanile minemiseks klõpsa nupul 'Mine täisekraanile' või vajuta F11.");
    }, 2000); // Shows after 2 seconds
  };
</script>
<!-- Buttons Positioned in the Upper Left -->
<div style="position: fixed; top: 10px; left: 10px; display: flex; flex-direction: row; gap: 10px;">
    <button onclick="showScrambledWord()" 
            style="padding: 10px 15px; font-size: 16px;">
        Mõtleb...
    </button>

    <button onclick="playNotification()" 
            style="padding: 10px 15px; font-size: 16px;">
        Järgmine palun...
    </button>
</div>

<!-- JavaScript for Floating Message -->
<script>
    function showMessage(message) {
        var msgBox = document.createElement("div");
        msgBox.innerText = message;
        msgBox.style.position = "fixed";
        msgBox.style.bottom = "60px";
        msgBox.style.left = "50%";
        msgBox.style.transform = "translateX(-50%)";
        msgBox.style.backgroundColor = "black";
        msgBox.style.color = "white";
        msgBox.style.padding = "10px 20px";
        msgBox.style.borderRadius = "5px";
        msgBox.style.fontSize = "18px";
        msgBox.style.zIndex = "1000";
        document.body.appendChild(msgBox);

        setTimeout(() => msgBox.remove(), 3000); // Remove after 3 seconds
    }

    function showScrambledWord() {
        var words = [
            "lumi", "ammu", "ära", "sulas", "metsaveeres", "palju", "sinilolli",
            "kimbukese", "sinilolli", "kinkisin", "ma", "sulle", "tänulikult", "selle", "eest", "suud", "sa", "andsid", "mulle",
            "mis", "sest", "et", "pimeneb", "ja", "nutab", "vana", "kakk",
            "näe", "taevaäär", "on", "helenduses", "uusik",
            "ja", "linnutee", "on", "elav", "vastuhakk",
            "kuid", "pimedusse", "viib", "meid", "öödetuusik",
            "on", "muhumaal", "röökiv", "põõsas", "ja", "auru", "puhuvad", "sead",
            "päike", "virutab", "oma", "kollase", "kinda", "tuulte", "sinisesse", "silmnäkku",
            "jalutud", "tuuled", "taaruvad",
            "ka", "keskpäevane", "päike", "on", "andrese", "häälega",
            "ma", "istun", "päikeselõõsas",
            "süda", "teisel", "pool", "halba", "ja", "head"
        ];

        var word = words[Math.floor(Math.random() * words.length)];
        var scrambled = word.split('').sort(() => 0.5 - Math.random()).join('');
        showMessage("Oota, mõtleb, kas '" + scrambled + "' on sõna?");
    }

    function playNotification() {
        var phrases = [
            "Ära tõin!",
            "Meil lobisemise eest palka ei maksta",
            "Ei ole rätsepmeister Kiir rumal miis",
            "Mis te vahite ringi!",
            "Näita, näita! Ega ma ei vaata!",
            "Prill, mida sa vahid?",
            "Teen tsikli korda, olen siit mülkast läinud",
            "Põgenemine, igatahes, aga mitte paaniline, vaid organiseeritud!",
            "Ja kuigi te olete täiesti harimata mats, tantsin ma siiski teiega kui võrdne võrdsega…",
            "Siuh-säuh present from pada kingdom",
            "Sellel mehel pole ajusid. Ma ise nägin.",
            "Mõnita, mõnita vanainimest!",
            "Tahan käin, tahan ei käi, niivõrd mõnus olen!",
            "Aktuaalne kaamera jääb nägemata!!!",
            "Ma olen vist vapper mees.",
            "Mõte maha, lähme ära!",
            "Nööri ärge puutuge, seda läheb mul endal pärast vaja!",
            "Tegelikult olen mina Liivimaa parim ratsutaja.",
            "Kahju, et me kohtusime, sa rikkusid mul tänase päeva ära!",
            "Mina oma otsust ei muuda!",
            "Kas me oleme ikka õigel teel?",
            "See ei ole lõpp, kõik kestab edasi. Kaitsku meid Jumal."
        ];

        var phrase = phrases[Math.floor(Math.random() * phrases.length)];
        showMessage(phrase);
    }
</script>

<!-- Camera Toggle Button (Top Left) -->
<button id="toggleCamera" onclick="toggleCamera()" 
        style="position: fixed; top: 10px; left: 10px; padding: 10px 15px; font-size: 16px;">
    Show Camera
</button>

<!-- Transparent Fullscreen ASCII Camera -->
<div id="ascii-cam-container" style="
    position: fixed; 
    top: 0; left: 0; 
    width: 100vw; height: 100vh; 
    background: rgba(0, 0, 0, 0.3); /* Semi-transparent */
    display: none; /* Hidden by default */
    pointer-events: none; /* Allows clicks to pass through */
    z-index: 9999;">
    <div id="ascii-cam" class="fade" style="text-align: center; margin-top: 20vh; font-size: 2vw;">
        <pre id="r-output"></pre>
    </div>
</div>

<video id="video" autoplay="true" style="display: none;"></video>
<canvas id="canvas" width="320" height="240" style="display: none;"></canvas>

<script>
    let cameraVisible = false;

    function toggleCamera() {
        cameraVisible = !cameraVisible;
        document.getElementById("ascii-cam-container").style.display = cameraVisible ? "block" : "none";
        document.getElementById("toggleCamera").innerText = cameraVisible ? "Hide Camera" : "Show Camera";
    }

    (() => {
        'use strict';

        let interval;
        let r_layer;
        const palette = [' ', '.', ':', '-', '=', '+', '*', '#', '%', '@']; // Better contrast

        const handle_video = stream => {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const video = document.getElementById('video');

            if ('srcObject' in video) {
                video.srcObject = stream;
            } else {
                video.src = window.URL.createObjectURL(stream);
            }

            video.addEventListener('loadedmetadata', () => {
                window.addEventListener('resize', () => set_canvas_dimensions(video, canvas, ctx));
                set_canvas_dimensions(video, canvas, ctx);
                play_video(video, canvas, ctx);
                setTimeout(() => {
                    document.getElementById('ascii-cam').style.opacity = 1;
                }, 1000);
            });
        };

        const handle_no_video = () => {
            setTimeout(() => {
                document.getElementById('ascii-cam').style.opacity = 1;
            }, 1000);
        };

        const play_video = (video, canvas, ctx) => {
            clearInterval(interval);
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            const image_data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
            const channels = 4;

            const pixels = Array.from(Array(Math.ceil(image_data.length / channels)), (_, i) =>
                image_data.slice(i * channels, i * channels + channels)
            );

            let r_output = '';
            pixels.forEach((pixel, i) => {
                if (i && i % canvas.width === 0) {
                    r_output += '\n';
                }

                const r_idx = Math.floor((pixel[0] / 255.0) * (palette.length - 1));
                r_output += palette[r_idx];
            });

            r_layer.textContent = r_output;
            interval = setInterval(() => play_video(video, canvas, ctx), 33);
        };

        window.addEventListener('load', () => {
            if (navigator.mediaDevices) {
                r_layer = document.getElementById('r-output');

                navigator.mediaDevices
                    .getUserMedia({ video: {} })
                    .then(handle_video)
                    .catch(handle_no_video);
            } else {
                handle_no_video();
            }
        });
    })();
</script>
</body>
</html>
